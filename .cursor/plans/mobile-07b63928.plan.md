<!-- 07b63928-5421-4a11-8f84-74bc1eafb59b 871c2701-91a5-4594-b56d-079a80892daa -->
# Mobile Text Readability Fix

## Problem Statement

Mobile visitors cannot read the text because:

1. White text spans are **empty in HTML** - populated only by JavaScript
2. Containers start at `opacity: 0` - become visible only via ScrollTrigger
3. No fallback if GSAP matchMedia fails to fire or fires late
4. Text visibility is 100% dependent on perfect animation timing

**This violates the core UX principle: Content first, animations second.**

## Solution

Make text **always visible by default** on mobile, with animations as progressive enhancement.

## Acceptance Criteria

### Must Have (Blocking):

- [ ] **AC1**: Mobile user sees white text "You need more than just another salesperson." immediately on page load (no JavaScript required)
- [ ] **AC2**: Mobile user sees red text "You need a system." immediately on scroll down (no animation delay can prevent reading)
- [ ] **AC3**: If JavaScript fails completely, mobile user can still read both text blocks (graceful degradation)
- [ ] **AC4**: Desktop experience remains unchanged (pinned cinematic animation)

### Should Have (High Priority):

- [ ] **AC5**: Animations still work when JavaScript loads correctly (fade in, slide up)
- [ ] **AC6**: Behavior is identical across Safari, Brave, Chrome on iOS
- [ ] **AC7**: Text is large enough to read comfortably on small screens (minimum 20px)

### Nice to Have:

- [ ] **AC8**: Reduced motion preference shows static text immediately with no animation attempt

## Changes to [`client/src/components/SimpleBridgeSection.tsx`](client/src/components/SimpleBridgeSection.tsx)

### Change 1: Add Mobile-Specific Refs (Lines 93-98)

**Critical Issue:**

Current ref validation (lines 126-145) checks ALL refs including `line1Ref`, `word1Ref`, etc. If we conditionally render for mobile without these refs, validation fails and animation setup exits early with "Missing refs, animation disabled".

**Fix:**

Add separate mobile-only refs that will be used for mobile text containers:

```typescript
// Existing desktop refs...
const word4Ref = useRef<HTMLSpanElement>(null);

// NEW: Mobile-specific refs (simple containers, no word-by-word splitting)
const mobileWhiteTextRef = useRef<HTMLDivElement>(null);
const mobileRedTextRef = useRef<HTMLDivElement>(null);
```

### Change 2: Make Ref Validation Conditional (Lines 126-145)

**Fix:**

Only validate refs that are actually needed based on viewport:

```typescript
useEffect(() => {
  // Always need these
  if (
    !sectionRef.current ||
    !whiteContainerRef.current ||
    !redContainerRef.current ||
    !conicFloodRef.current ||
    !heatDistortionRef.current ||
    !emberContainerRef.current ||
    !pageIlluminationRef.current
  ) {
    console.warn('SimpleBridgeSection: Missing refs, animation disabled');
    return;
  }

  // Desktop needs these, mobile doesn't
  const isDesktop = window.matchMedia('(min-width: 768px)').matches;
  if (isDesktop && (
    !whiteTextRef.current ||
    !line1Ref.current ||
    !line2Ref.current ||
    !line3Ref.current ||
    !word1Ref.current ||
    !word2Ref.current ||
    !word3Ref.current ||
    !word4Ref.current
  )) {
    console.warn('SimpleBridgeSection: Missing desktop refs, animation disabled');
    return;
  }

  // Mobile needs these
  const isMobile = window.matchMedia('(max-width: 767px)').matches;
  if (isMobile && (!mobileWhiteTextRef.current || !mobileRedTextRef.current)) {
    console.warn('SimpleBridgeSection: Missing mobile refs, animation disabled');
    return;
  }

  // ... rest of setup
```

### Change 3: Render Text in HTML for Mobile (Lines 547-560)

**Current Issue:**

Empty spans that depend on JavaScript to populate.

**Fix:**

Render actual text for mobile using mobile refs, keep empty spans for desktop:

```typescript
{/* White Text */}
<div ref={whiteContainerRef} className={`flex items-center justify-center z-10 ${isMobile ? 'relative min-h-[50vh] py-12' : 'absolute inset-0 pointer-events-none'}`}>
  <div className="max-w-2xl text-center px-6">
    {isMobile ? (
      // Mobile: Real text in HTML with mobile ref
      <p ref={mobileWhiteTextRef} className="text-xl text-white font-semibold leading-relaxed">
        You need more<br />
        than just<br />
        another salesperson.
      </p>
    ) : (
      // Desktop: Empty spans for character animation
      <p ref={whiteTextRef} className="text-xl md:text-2xl lg:text-3xl text-white font-semibold leading-relaxed">
        <span ref={line1Ref}></span><br />
        <span ref={line2Ref}></span><br />
        <span ref={line3Ref}></span>
      </p>
    )}
  </div>
</div>
```

### Change 2: Set Defensive Defaults for Mobile Visibility

**Current Issue (line 233):**

```typescript
gsap.set(whiteContainerRef.current, { opacity: 0, y: 30 });
```

Container starts invisible. If ScrollTrigger fails, text never appears.

**Fix:**

Use CSS to set initial visibility based on viewport, with GSAP overriding only when animations are enabled.

Add to component:

```typescript
// Set defensive visibility for mobile before animations run
useEffect(() => {
  if (typeof window === 'undefined') return;
  
  if (isMobile && whiteContainerRef.current && redContainerRef.current) {
    // Mobile: Start visible by default (CSS will be overridden by GSAP if it loads)
    whiteContainerRef.current.style.opacity = '1';
    redContainerRef.current.style.opacity = '1';
  }
}, [isMobile]);
```

Then in `mobileTimeline()`, explicitly set `opacity: 0` ONLY after GSAP loads:

```typescript
gsap.set(whiteContainerRef.current, { opacity: 0, y: 30 });
```

This ensures text is visible by default, then hidden for animation.

### Change 3: Simplify Mobile Red Text Rendering

**Current Issue:**

Red text uses same word-by-word refs as desktop (word1Ref, word2Ref, etc.) but mobile doesn't need this complexity.

**Fix:**

Render simple HTML text for mobile, keep complex refs for desktop only:

```typescript
{isMobile ? (
  // Mobile: Simple readable text
  <h2 className="text-4xl font-black text-center" style={standardGlow}>
    You need a system.
  </h2>
) : (
  // Desktop: Word-by-word animation refs
  <h2 className="text-5xl md:text-7xl lg:text-9xl font-black leading-tight text-center max-w-4xl mx-auto relative z-20">
    <span ref={word1Ref} className="inline-block" style={{ ...standardGlow, marginRight: '0.25em' }}>You</span>
    {/* ... other word refs ... */}
  </h2>
)}
```

### Change 4: Remove Empty Span Dependencies from mobileTimeline

**Current Issue:**

`mobileTimeline()` still calls `setWhiteTextContent('static')` which tries to populate empty spans that don't exist in the mobile JSX.

**Fix:**

Make `mobileTimeline()` skip text content manipulation:

```typescript
const mobileTimeline = () => {
  const ctx = gsap.context(() => {
    // Mobile text is already in HTML, no need to set content
    // Just animate the containers
    
    gsap.set(whiteContainerRef.current, { opacity: 0, y: 30 });
    gsap.set(redContainerRef.current, { opacity: 0, y: 30 });
    
    ScrollTrigger.create({
      trigger: whiteContainerRef.current,
      start: 'top 85%',
      once: true,
      animation: gsap.to(whiteContainerRef.current, {
        opacity: 1,
        y: 0,
        duration: 0.8,
        ease: 'power2.out',
      }),
    });
    
    // Similar for red container...
  }, sectionRef);
  
  return () => ctx.revert();
};
```

## Testing Checklist

After implementation, verify:

1. **Disable JavaScript in browser** → Mobile text is readable ✅
2. **Enable JavaScript** → Mobile text animates in smoothly ✅  
3. **Slow 3G network** → Text appears before animations load ✅
4. **Safari iOS** → Text is readable and consistent ✅
5. **Brave iOS** → Text is readable and consistent ✅
6. **Desktop browser** → Cinematic animation unchanged ✅
7. **Resize from mobile to desktop** → No broken states ✅

## Key Principle

**Progressive Enhancement:**

- HTML/CSS: Text is visible and readable (baseline)
- JavaScript: Animations enhance the experience (optional)
- Never: JavaScript required to read content (accessibility violation)

### To-dos

- [ ] Audit SimpleBridgeSection desktop timeline
- [ ] Add responsive ScrollTrigger branches
- [ ] Simplify mobile visuals & particles
- [ ] Test on devices and update docs
- [ ] Audit SimpleBridgeSection desktop timeline
- [ ] Add responsive ScrollTrigger branches
- [ ] Simplify mobile visuals & particles
- [ ] Test on devices and update docs
- [ ] Trace current matchMedia behavior
- [ ] Implement new gsap.matchMedia conditions
- [ ] Verify mobile/reduced-motion behaviour
- [ ] Audit SimpleBridgeSection desktop timeline
- [ ] Add responsive ScrollTrigger branches
- [ ] Simplify mobile visuals & particles
- [ ] Test on devices and update docs
- [ ] Confirm current matchMedia failure
- [ ] Refactor gsap.matchMedia logic
- [ ] Test on devices and update docs
- [ ] Audit SimpleBridgeSection desktop timeline
- [ ] Add responsive ScrollTrigger branches
- [ ] Simplify mobile visuals & particles
- [ ] Test on devices and update docs
- [ ] Confirm matchMedia behavior on iOS
- [ ] Refactor gsap.matchMedia registration
- [ ] Test on devices and update docs
- [ ] Audit SimpleBridgeSection desktop timeline
- [ ] Add responsive ScrollTrigger branches
- [ ] Simplify mobile visuals & particles
- [ ] Test on devices and update docs
- [ ] Refactor mobile timeline and ScrollTrigger bounds
- [ ] Add defensive visibility defaults
- [ ] Verify fix on iOS devices
- [ ] Mobile scroll animation fix complete
- [ ] Switch mobile animation to pinned scroll
- [ ] Test pinned mobile interaction on devices
- [ ] Mobile animation with halt effect restored
- [ ] Audit SimpleBridgeSection desktop timeline
- [ ] Add responsive ScrollTrigger branches
- [ ] Simplify mobile visuals & particles
- [ ] Test on devices and update docs
- [ ] Update CSS/JSX for mobile vertical stack
- [ ] Implement sequential reveal mobile timeline
- [ ] Verify desktop regression and mobile flow
- [ ] Mobile vertical reveal implementation complete
- [ ] Audit SimpleBridgeSection desktop timeline
- [ ] Add responsive ScrollTrigger branches
- [ ] Simplify mobile visuals & particles
- [ ] Test on devices and update docs
- [ ] Implement robust `useIsMobile` hook/logic
- [ ] Refactor JSX for CSS-driven layout switching
- [ ] Simplify mobile animation to basic reveals
- [ ] Test across iOS browsers
- [ ] Hardened mobile layout & detection complete